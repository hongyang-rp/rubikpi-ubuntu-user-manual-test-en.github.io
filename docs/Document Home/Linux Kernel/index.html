<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Document Home/Linux Kernel" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Linux Kernel | RUBIK Pi Ubuntu24.04 user Guide</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rubikpi-ubuntu-user-manual-test-en.github.io/rubikpi-ubuntu-user-manual-test-en.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://rubikpi-ubuntu-user-manual-test-en.github.io/rubikpi-ubuntu-user-manual-test-en.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://rubikpi-ubuntu-user-manual-test-en.github.io/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linux Kernel | RUBIK Pi Ubuntu24.04 user Guide"><meta data-rh="true" name="description" content="This chapter describes how to configure and build a customized kernel for your RUBUK Pi 3."><meta data-rh="true" property="og:description" content="This chapter describes how to configure and build a customized kernel for your RUBUK Pi 3."><link data-rh="true" rel="icon" href="/rubikpi-ubuntu-user-manual-test-en.github.io/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rubikpi-ubuntu-user-manual-test-en.github.io/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel"><link data-rh="true" rel="alternate" href="https://rubikpi-ubuntu-user-manual-test-en.github.io/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel" hreflang="en"><link data-rh="true" rel="alternate" href="https://rubikpi-ubuntu-user-manual-test-en.github.io/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Document Home","item":"https://rubikpi-ubuntu-user-manual-test-en.github.io/rubikpi-ubuntu-user-manual-test-en.github.io/docs/category/document-home"},{"@type":"ListItem","position":2,"name":"Linux Kernel","item":"https://rubikpi-ubuntu-user-manual-test-en.github.io/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel"}]}</script><link rel="alternate" type="application/rss+xml" href="/rubikpi-ubuntu-user-manual-test-en.github.io/blog/rss.xml" title="RUBIK Pi Ubuntu24.04 user Guide RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rubikpi-ubuntu-user-manual-test-en.github.io/blog/atom.xml" title="RUBIK Pi Ubuntu24.04 user Guide Atom Feed"><link rel="stylesheet" href="/rubikpi-ubuntu-user-manual-test-en.github.io/assets/css/styles.3ab308d8.css">
<script src="/rubikpi-ubuntu-user-manual-test-en.github.io/assets/js/runtime~main.c5b5f802.js" defer="defer"></script>
<script src="/rubikpi-ubuntu-user-manual-test-en.github.io/assets/js/main.d5cf0e10.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/rubikpi-ubuntu-user-manual-test-en.github.io/img/rubik-pi-logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rubikpi-ubuntu-user-manual-test-en.github.io/"><div class="navbar__logo"><img src="/rubikpi-ubuntu-user-manual-test-en.github.io/img/rubik-pi-logo.png" alt="RUBIK Pi Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rubikpi-ubuntu-user-manual-test-en.github.io/img/rubik-pi-logo.png" alt="RUBIK Pi Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">RUBIK Pi Ubuntu24.04 User Guide</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/category/document-home">Tutorial</a><a class="navbar__item navbar__link" href="/rubikpi-ubuntu-user-manual-test-en.github.io/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/rubikpi-ai" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/category/document-home">Document Home</a><button aria-label="Collapse sidebar category &#x27;Document Home&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Quick Start/">Quick Start</a><button aria-label="Collapse sidebar category &#x27;Quick Start&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Quick Start/Accessories">Accessories</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Quick Start/setup-device">setup-device</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Quick Start/run-sample-applications">run-sample-applications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Quick Start/update-software">update-software</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Quick Start/further-study">Further study</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel">Linux Kernel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/develop-applications">Develop your own application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Peripherals and Interfaces">Peripherals and Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Camera software">Camera software</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/AI">Artificial Intelligence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Robot development">Robot development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Troubleshooting">FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/IoT connectivity">IoT connectivity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Datashet">Datashet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/development-regulatory-notice">Development regulatory notice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/ubuntu-desktop-vs-server">ubuntu-desktop-vs-server</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rubikpi-ubuntu-user-manual-test-en.github.io/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/category/document-home"><span>Document Home</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Linux Kernel</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Linux Kernel</h1></header>
<p>This chapter describes how to configure and build a customized kernel for your RUBUK Pi 3.</p>
<p>The RUBIK Pi kernel is hosted on <a href="https://github.com/rubikpi-ai/linux-ubuntu" target="_blank" rel="noopener noreferrer">GitHub</a>. The update lags behind the <a href="https://github.com/torvalds/linux" target="_blank" rel="noopener noreferrer">upstream Linux kernel</a>. Currently, the kernel version for RUBIK Pi 3 Ubuntu 24.04 LTS is 6.8.12.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-kernel">Update the kernel<a href="#update-the-kernel" class="hash-link" aria-label="Direct link to Update the kernel" title="Direct link to Update the kernel">​</a></h2>
<p>When using the <code>sudo apt upgrade</code> command for an update, your kernel will automatically be updated to the latest stable version. If you want to try the latest unstable test kernel, <a href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel#downloade_linux_code">download the latest kernel source code</a> and <a href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel#Native_and_cross_builds">manually compile and update the kernel</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="compile-the-kernel">Compile the kernel<a href="#compile-the-kernel" class="hash-link" aria-label="Direct link to Compile the kernel" title="Direct link to Compile the kernel">​</a></h2>
<p>There are two ways to compile the kernel: native builds and cross-compilation.</p>
<p>The compilers and linkers installed by default on RUBIK Pi 3 can build executable files that run on RUBIK Pi 3, which is known as the native build.</p>
<p>Cross-compilation, on the other hand, is the process of generating executable code for a different platform, such as building ARM architecture executables on an x86_64 machine.</p>
<p><img decoding="async" loading="lazy" src="/rubikpi-ubuntu-user-manual-test-en.github.io/assets/images/CompileDiagram-8b62bf43f82626fc212221405dd6a471.PNG" width="1728" height="252" class="img_ev3q"></p>
<a id="downloade_linux_code"></a>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="download-kernel-source-code">Download kernel source code<a href="#download-kernel-source-code" class="hash-link" aria-label="Direct link to Download kernel source code" title="Direct link to Download kernel source code">​</a></h3>
<p>Before building for any target platform, you need the kernel source code. To get the kernel source code, you will need Git. If you haven&#x27;t installed Git, install it on your device first:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install git</span><br></span></code></pre></div></div>
<p>Next, download the source code for the latest RUBIK Pi 3 kernel:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/rubikpi-ai/linux-ubuntu.git</span><br></span></code></pre></div></div>
<p>This may take a few minutes.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The above <code>git clone</code> command will download the current active branch, including all commit history and file history. If you only need the latest source code, use the <code>git clone --depth 1 https://github.com/rubikpi-ai/linux-ubuntu.git</code> command to reduce the download size.</p><p>If you want to download the source code for other branches, switch to the desired branch after cloning: Go to the download directory and run the <code>git checkout &lt;branch-name&gt;</code> command to switch to the desired branch.</p><p>Regarding the list of available branches, visit <a href="https://github.com/rubikpi-ai/linux-ubuntu.git" target="_blank" rel="noopener noreferrer">RUBIK Pi kernel GitHub repository</a>.</p></div></div>
<a id="Native_and_cross_builds"></a>
<p>Now that you have the kernel source code, you can either build a new kernel locally or cross-compile it.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Native builds</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Cross compilation</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p><strong>First, install the compilation dependencies on RUBIK Pi 3</strong></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install bc bison flex libssl-dev make gcc debhelper cpio dwarfdump \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zstd llvm clang libclang-dev gawk dwarves libelf-dev dkms zip rustup</span><br></span></code></pre></div></div><p><strong>Then, navigate to the kernel directory and set up the Rust environment:</strong></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd linux-ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cargo install --git https://github.com/rust-lang/rust-bindgen --tag v0.65.1 bindgen-cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp ~/.cargo/bin/bindgen /usr/bin/bindgen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp /usr/bin/bindgen /usr/bin/bindgen-0.65</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rustup override set $(scripts/min-tool-version.sh rustc)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rustup component add rust-src</span><br></span></code></pre></div></div><p>If the following content appears, press <strong>Enter</strong> to use the default configuration.
<img decoding="async" loading="lazy" src="/rubikpi-ubuntu-user-manual-test-en.github.io/assets/images/20250713-195811-e241faacabfdd16db6fdf848233da7b8.jpg" width="690" height="110" class="img_ev3q"></p><p>Run the following command to verify that the Rust environment is configured successfully.</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make LLVM=1 rustavailable</span><br></span></code></pre></div></div><p>If the Rust environment is configured successfully, the following output will appear:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Rust is available!</span><br></span></code></pre></div></div><p><strong>Next, build the kernel. This step may take a long time.</strong></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fakeroot debian/rules clean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fakeroot debian/rules build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fakeroot debian/rules binary</span><br></span></code></pre></div></div><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The command <code>fakeroot debian/rules build</code> will automatically compile the kernel in parallel based on the number of CPU cores. RUBIK Pi has 8 CPU cores, so 8 threads will be used to compile the kernel.</p></div></div><p><strong>Install the kernel:</strong></p><p>Navigate to the parent directory of linux-ubuntu, then install the generated kernel package onto the system.</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo dpkg -i linux-*.deb</span><br></span></code></pre></div></div><p><strong>Finally, run the following command to reboot your RUBIK Pi 3 and boot into the newly compiled kernel:</strong></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo reboot</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>You need a suitable Linux cross-compilation host. We recommend that you perform the cross-compilation within a Docker container hosted on an Ubuntu 24.04 system.</p><p><strong>First, click <a href="https://thundercomm.s3.dualstack.ap-northeast-1.amazonaws.com/uploads/web/rubik-pi-3/tools/ubuntu-24.04.tar" target="_blank" rel="noopener noreferrer">here</a> to download the Docker image.</strong>
<strong>Run the following command to import the Docker image and run it:</strong></p><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If you have not installed Docker, run the <code>apt install docker.io</code> command to install Docker.
When running Docker, you need to specify the local working directory to the Docker container. For example, <em>/home/rubikpi/ubuntu</em> is the local working directory, and <em>/home/ubuntu/prj</em> is the working directory inside the Docker container. Make sure that your local working directory contains the kernel source code directory <em>linux-ubuntu</em>.</p></div></div><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo docker load -i ubuntu-24.04.tar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo docker run --name  ubuntu24.04 --privileged -it -v /home/rubikpi/ubuntu:/home/ubuntu/prj dokken/ubuntu-24.04 /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo passwd root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo passwd ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su ubuntu</span><br></span></code></pre></div></div><p><strong>Install the build dependencies in Ubuntu 24.04 Docker:</strong></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install -y debhelper gcc-13-aarch64-linux-gnu/noble-updates \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc-11-aarch64-linux-gnu g++-11-aarch64-linux-gnu cpio dwarfdump/noble \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zstd llvm clang libclang-dev make gawk flex bison git libssl-dev bc dwarves \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libelf-dev dkms zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Navigate to the kernel directory and configure the Rust environment:**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd prj/linux-ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cargo install --git https://github.com/rust-lang/rust-bindgen --tag v0.65.1 bindgen-cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp ~/.cargo/bin/bindgen /usr/bin/bindgen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp /usr/bin/bindgen /usr/bin/bindgen-0.65</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rustup override set $(scripts/min-tool-version.sh rustc)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rustup component add rust-src</span><br></span></code></pre></div></div><p>If the following content appears, press <strong>Enter</strong> to use the default configuration.
<img decoding="async" loading="lazy" src="/rubikpi-ubuntu-user-manual-test-en.github.io/assets/images/20250713-195811-e241faacabfdd16db6fdf848233da7b8.jpg" width="690" height="110" class="img_ev3q"></p><p>Run the following command to verify that the Rust environment is configured successfully.</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make LLVM=1 rustavailable</span><br></span></code></pre></div></div><p>If the Rust environment is configured successfully, the following output will appear.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Rust is available!</span><br></span></code></pre></div></div><p><strong>Next, build the kernel. This step may take a long time.</strong></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export ARCH=arm64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export $(dpkg-architecture -aarm64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CROSS_COMPILE=aarch64-linux-gnu-</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export HOSTCC=clang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fakeroot debian/rules clean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fakeroot debian/rules build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fakeroot debian/rules binary</span><br></span></code></pre></div></div><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The command <code>fakeroot debian/rules build</code> will automatically compile the kernel in parallel based on the number of CPU cores. RUBIK Pi has 8 CPU cores, so 8 threads will be used to compile the kernel.</p></div></div><p><strong>Install the kernel</strong></p><p>Next, navigate to the parent directory of the <em>linux-ubuntu</em> directory, and transfer the generated kernel package to RUBIK Pi 3. You can use a USB drive, SSD, or use commands like <code>scp</code> or <code>adb push</code> to transfer the files.
Run the following command to install the kernel on RUBIK Pi 3：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo dpkg -i linux-*.deb</span><br></span></code></pre></div></div><p><strong>Finally, run the following command to run the newly compiled kernel on RUBIK Pi 3:</strong></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo reboot</span><br></span></code></pre></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configured-the-kernel">Configured the kernel<a href="#configured-the-kernel" class="hash-link" aria-label="Direct link to Configured the kernel" title="Direct link to Configured the kernel">​</a></h2>
<p>The Linux kernel is highly configurable. Some users may want to modify the default configuration to fit their own needs, such as enabling new or experimental network protocols, or enabling support for new hardware.</p>
<p>Configuration is typically done through the make menuconfig interface. Alternatively, you can edit the <em>.config</em> file, but this may be more challenging.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prepare-for-the-configuration">Prepare for the configuration<a href="#prepare-for-the-configuration" class="hash-link" aria-label="Direct link to Prepare for the configuration" title="Direct link to Prepare for the configuration">​</a></h3>
<p>The menuconfig tool requires the ncurses development headers to compile and run properly. To install these headers, run the following command:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install libncurses5-dev</span><br></span></code></pre></div></div>
<p>Next, <a href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel#downloade_linux_code">download the kernel source code</a>. It&#x27;s important to note that you should have already completed the steps for either <a href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel#Native_and_cross_builds">native builds or cross-compilation</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="menuconfig">menuconfig<a href="#menuconfig" class="hash-link" aria-label="Direct link to menuconfig" title="Direct link to menuconfig">​</a></h3>
<p>After setting up everything, you can now compile and run the menuconfig program as follows:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Native builds</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Cross-compilation</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd linux-ubuntu/debian/build/build-rubikpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make menuconfig</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd prj/linux-ubuntu/debian/build/build-rubikpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- menuconfig</span><br></span></code></pre></div></div></div></div></div>
<p>Use the keyboard to operate menuconfig:</p>
<ul>
<li>
<p>Use the arrow keys for navigation.</p>
</li>
<li>
<p>Press <strong>Enter</strong> to enter a submenu (indicated by ---&gt;).</p>
</li>
<li>
<p>Press <strong>Esc</strong> twice to go back to the previous level or exit.</p>
</li>
<li>
<p>Use the space bar to toggle the enable/disable state of an option.</p>
</li>
<li>
<p>Press <strong>Enter</strong> to open a submenu, use the arrow keys to browse the submenu, then press <strong>Enter</strong> again to select the state.</p>
</li>
<li>
<p>Press <strong>H</strong> to get help on an option or menu.</p>
</li>
</ul>
<p>After a quick compilation, the menuconfig will display a list of submenus containing all the configurable options. There are many options, so please read through them patiently. On your first attempt, do not enable or disable a large number of options. The configuration can be easily broken, so it&#x27;s best to make only a few changes at a time and familiarize yourself with the configuration and build process.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="save-changes">Save changes<a href="#save-changes" class="hash-link" aria-label="Direct link to Save changes" title="Direct link to Save changes">​</a></h3>
<p>After making the changes, press and hold the <strong>Esc</strong> key until the system prompts you to save the new configuration. By default, it will be saved to the <em>.config</em> file. You can save and load the configuration by copying this file.</p>
<p>Once the customization is complete, you can now proceed to build the kernel.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Native builds</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Cross-compilation</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd linux-ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fakeroot debian/rules build</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd prj/linux-ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ARCH=arm64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export $(dpkg-architecture -aarm64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CROSS_COMPILE=aarch64-linux-gnu-</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export HOSTCC=clang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fakeroot debian/rules build</span><br></span></code></pre></div></div></div></div></div>
<p>After the kernel has been built, refer to the methods described <a href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Linux Kernel#Native_and_cross_builds">Compile the kernel</a> to install the kernel.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="apply-kernel-patches">Apply kernel patches<a href="#apply-kernel-patches" class="hash-link" aria-label="Direct link to Apply kernel patches" title="Direct link to Apply kernel patches">​</a></h2>
<p>When building a custom kernel, you may want to apply patches or a patch set (a collection of patches) to the Linux kernel.</p>
<p>Hardware manufacturers sometimes provide patch sets as a temporary measure to support new hardware before the patches are incorporated into the Linux kernel and the RUBIK Pi kernel. However, there are also patch sets for other purposes, such as enabling full kernel preemption to support real-time use.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="confirm-your-kernel-version">Confirm your kernel version<a href="#confirm-your-kernel-version" class="hash-link" aria-label="Direct link to Confirm your kernel version" title="Direct link to Confirm your kernel version">​</a></h3>
<p>To check the kernel version currently running on your device, run the following command:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uname -r</span><br></span></code></pre></div></div>
<p>Before applying a patch, it is important to check the kernel version. In the kernel source directory, run the following command to check the kernel version:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">head Makefile -n 4</span><br></span></code></pre></div></div>
<p>An output similar to the following should appear.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># SPDX-License-Identifier: GPL-2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VERSION = 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PATCHLEVEL = 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SUBLEVEL = 12</span><br></span></code></pre></div></div>
<p>In this case, the source code is applicable for the 6.8.12 kernel.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="apply-patches">Apply patches<a href="#apply-patches" class="hash-link" aria-label="Direct link to Apply patches" title="Direct link to Apply patches">​</a></h3>
<p>The application of the patch depends on the format in which the patch is distributed.</p>
<p>Developers distribute most patches as single files. Use the patch utility to apply these patches. The following commands will download, extract, and use the real-time kernel patch to patch our example kernel version:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://www.kernel.org/pub/linux/kernel/projects/rt/6.8/patch-6.8.2-rt11.patch.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gunzip patch-6.8.2-rt11.patch.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat patch-6.8.2-rt11.patch.gz | patch -p1</span><br></span></code></pre></div></div>
<p>Some developers may distribute patches in the form of an email, which is a folder containing multiple patch files. Use Git to apply these patches.<br>
<!-- -->Before using Git to apply the email patches, configure the local Git installation with the name and email:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git config --global user.name &quot;your name&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config --global user.email &quot;your email&quot;</span><br></span></code></pre></div></div>
<p>To apply the patches distributed via emails using Git, run the following command:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git am -3 /path/to/patches/*</span><br></span></code></pre></div></div>
<p>Be sure to follow the instructions provided by the patch distributor. For example, some patch sets may need to be applied against a specific commit.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kernel-header-files">Kernel header files<a href="#kernel-header-files" class="hash-link" aria-label="Direct link to Kernel header files" title="Direct link to Kernel header files">​</a></h3>
<p>To compile a kernel module, you need the Linux kernel header files. These header files provide the function and structure definitions required to build code that interfaces with the kernel.</p>
<p>If you cloned the entire kernel from GitHub, these header files are included in the source code tree. If you do not need all the extra files, use the <code>apt</code> command to install only the kernel header files on RUBIK Pi 3.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install linux-headers-$(uname -r)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Installing the kernel header files may take a few minutes. There is no progress indicator during the installation.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="contribute-your-code">Contribute your code<a href="#contribute-your-code" class="hash-link" aria-label="Direct link to Contribute your code" title="Direct link to Contribute your code">​</a></h2>
<p>You may want to add something to the kernel out of different reasons:</p>
<ul>
<li>
<p>You have written some RUBIK Pi-specific code and want everyone to benefit from it.</p>
</li>
<li>
<p>You have written a generic Linux kernel driver for a device and want everyone to be able to use it.</p>
</li>
<li>
<p>You have fixed a generic kernel bug.</p>
</li>
<li>
<p>You have fixed a RUBIK Pi-specific kernel bug.</p>
</li>
</ul>
<p>For RUBIK Pi-specific changes or bug fixes, submit a Pull Request (PR) to the RUBIK Pi kernel. For general Linux kernel changes (such as new drivers), first submit a Pull Request to the upstream Linux kernel. Once the Linux kernel accepts your changes, we will merge them into the RUBIK Pi kernel during kernel updates.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contribute-code-to-the-rubik-pi-kernel">Contribute code to the RUBIK Pi kernel<a href="#contribute-code-to-the-rubik-pi-kernel" class="hash-link" aria-label="Direct link to Contribute code to the RUBIK Pi kernel" title="Direct link to Contribute code to the RUBIK Pi kernel">​</a></h3>
<p>First, fork the <a href="https://github.com/rubikpi-ai/linux-ubuntu" target="_blank" rel="noopener noreferrer">RUBIK Pi kernel repository</a> clone it to your development device. Then, you can make changes, test them, and submit them to your forked repository.</p>
<p>Next, submit a pull request containing your changes to the <a href="https://github.com/rubikpi-ai/linux-ubuntu" target="_blank" rel="noopener noreferrer">RUBIK Pi kernel repository</a>. RUBIK Pi engineers will review your contribution and provide feedback for improvements. Once approved, we will merge your changes, which will eventually be included in the stable version of the RUBIK Pi kernel.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contribute-code-to-the-upstream-linux-kernel">Contribute code to the upstream Linux kernel<a href="#contribute-code-to-the-upstream-linux-kernel" class="hash-link" aria-label="Direct link to Contribute code to the upstream Linux kernel" title="Direct link to Contribute code to the upstream Linux kernel">​</a></h3>
<p>First, clone the <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git" target="_blank" rel="noopener noreferrer">Linux kernel tree</a> to your development device. Then, you can make changes, test them, and commit them to your local tree.</p>
<p>When your changes are ready, submit them to the Linux kernel community. Linux kernel development is conducted through mailing lists, not on GitHub. To get your changes into Linux, send them as patches through email to the community. Please follow the guidelines <a href="https://www.kernel.org/doc/html/latest/process/submitting-patches.html" target="_blank" rel="noopener noreferrer">Submitting patches: the essential guide to getting your code into the kernel</a> and <a href="https://www.kernel.org/doc/html/latest/process/coding-style.html" target="_blank" rel="noopener noreferrer">Linux kernel coding style</a>. Linux kernel contributors will review your contribution and provide feedback for improvements. Once approved, they will merge your changes. Eventually, these changes will make it into a long-term Linux kernel release. Once we&#x27;ve tested that the long-term release is compatible with the RUBIK Pi kernel, your changes will be included in the stable version of the RUBIK Pi kernel.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/hongyang-rp/rubikpi-ubuntu-user-manual-test-en.github.io/tree/main/docs/Document Home/2.Linux Kernel.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Quick Start/further-study"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Further study</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/develop-applications"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Develop your own application</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#update-the-kernel" class="table-of-contents__link toc-highlight">Update the kernel</a></li><li><a href="#compile-the-kernel" class="table-of-contents__link toc-highlight">Compile the kernel</a><ul><li><a href="#download-kernel-source-code" class="table-of-contents__link toc-highlight">Download kernel source code</a></li></ul></li><li><a href="#configured-the-kernel" class="table-of-contents__link toc-highlight">Configured the kernel</a><ul><li><a href="#prepare-for-the-configuration" class="table-of-contents__link toc-highlight">Prepare for the configuration</a></li><li><a href="#menuconfig" class="table-of-contents__link toc-highlight">menuconfig</a></li><li><a href="#save-changes" class="table-of-contents__link toc-highlight">Save changes</a></li></ul></li><li><a href="#apply-kernel-patches" class="table-of-contents__link toc-highlight">Apply kernel patches</a><ul><li><a href="#confirm-your-kernel-version" class="table-of-contents__link toc-highlight">Confirm your kernel version</a></li><li><a href="#apply-patches" class="table-of-contents__link toc-highlight">Apply patches</a></li><li><a href="#kernel-header-files" class="table-of-contents__link toc-highlight">Kernel header files</a></li></ul></li><li><a href="#contribute-your-code" class="table-of-contents__link toc-highlight">Contribute your code</a><ul><li><a href="#contribute-code-to-the-rubik-pi-kernel" class="table-of-contents__link toc-highlight">Contribute code to the RUBIK Pi kernel</a></li><li><a href="#contribute-code-to-the-upstream-linux-kernel" class="table-of-contents__link toc-highlight">Contribute code to the upstream Linux kernel</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/qualcomm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/Qualcomm" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/rubikpi-ubuntu-user-manual-test-en.github.io/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/rubikpi-ai" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>