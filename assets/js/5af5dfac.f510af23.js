"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[536],{834:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/image-124-f8c3c5533751ddd8dfbfc4bd201144f5.png"},1092:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/20250314-155503-20e965abe4c5f3b7be69896d763ec9eb.jpg"},1470:(e,n,r)=>{r.d(n,{A:()=>I});var s=r(6540),t=r(4164),a=r(3104),c=r(6347),i=r(205),l=r(7485),o=r(1682),d=r(679);function u(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:n,children:r}=e;return(0,s.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:r,default:s}})=>({value:e,label:n,attributes:r,default:s}))}(r);return function(e){const n=(0,o.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,r])}function m({value:e,tabValues:n}){return n.some(n=>n.value===e)}function p({queryString:e=!1,groupId:n}){const r=(0,c.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(t),(0,s.useCallback)(e=>{if(!t)return;const n=new URLSearchParams(r.location.search);n.set(t,e),r.replace({...r.location,search:n.toString()})},[t,r])]}function x(e){const{defaultValue:n,queryString:r=!1,groupId:t}=e,a=h(e),[c,l]=(0,s.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const r=n.find(e=>e.default)??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a})),[o,u]=p({queryString:r,groupId:t}),[x,b]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[r,t]=(0,d.Dv)(n);return[r,(0,s.useCallback)(e=>{n&&t.set(e)},[n,t])]}({groupId:t}),g=(()=>{const e=o??x;return m({value:e,tabValues:a})?e:null})();(0,i.A)(()=>{g&&l(g)},[g]);return{selectedValue:c,selectValue:(0,s.useCallback)(e=>{if(!m({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),b(e)},[u,b,a]),tabValues:a}}var b=r(2303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=r(4848);function f({className:e,block:n,selectedValue:r,selectValue:s,tabValues:c}){const i=[],{blockElementScrollPositionUntilNextRender:l}=(0,a.a_)(),o=e=>{const n=e.currentTarget,t=i.indexOf(n),a=c[t].value;a!==r&&(l(n),s(a))},d=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const r=i.indexOf(e.currentTarget)+1;n=i[r]??i[0];break}case"ArrowLeft":{const r=i.indexOf(e.currentTarget)-1;n=i[r]??i[i.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:c.map(({value:e,label:n,attributes:s})=>(0,j.jsx)("li",{role:"tab",tabIndex:r===e?0:-1,"aria-selected":r===e,ref:e=>{i.push(e)},onKeyDown:d,onClick:o,...s,className:(0,t.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":r===e}),children:n??e},e))})}function v({lazy:e,children:n,selectedValue:r}){const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=a.find(e=>e.props.value===r);return e?(0,s.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:a.map((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==r}))})}function _(e){const n=x(e);return(0,j.jsxs)("div",{className:(0,t.A)("tabs-container",g.tabList),children:[(0,j.jsx)(f,{...n,...e}),(0,j.jsx)(v,{...n,...e})]})}function I(e){const n=(0,b.A)();return(0,j.jsx)(_,{...e,children:u(e.children)},String(n))}},1611:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/20250314-155452-0c6d27e21c38ab964508a570da3cd46d.jpg"},1897:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/20250314-155519-bc2c46b5faa0ce10b03a185e5d52d6e3.jpg"},2859:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"Document Home/Peripherals and Interfaces/CSI","title":"CSI","description":"Camera Serial Interface (CSI)","source":"@site/docs/Document Home/2.Peripherals and Interfaces/3. CSI.md","sourceDirName":"Document Home/2.Peripherals and Interfaces","slug":"/Document Home/Peripherals and Interfaces/CSI","permalink":"/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Peripherals and Interfaces/CSI","draft":false,"unlisted":false,"editUrl":"https://github.com/hongyang-rp/rubikpi-ubuntu-user-manual-test-en.github.io/tree/main/docs/Document Home/2.Peripherals and Interfaces/3. CSI.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"USB","permalink":"/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Peripherals and Interfaces/USB"},"next":{"title":"HDMI","permalink":"/rubikpi-ubuntu-user-manual-test-en.github.io/docs/Document Home/Peripherals and Interfaces/HDMI"}}');var t=r(4848),a=r(8453);r(1470),r(9365);const c={},i=void 0,l={},o=[{value:"Camera Serial Interface (CSI)",id:"camera-serial-interface-csi",level:2},{value:"Connect the camera cable",id:"connect-the-camera-cable",level:3},{value:"Use cameras",id:"use-cameras",level:3},{value:"Troubleshoot camera issues",id:"troubleshoot-camera-issues",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"camera-serial-interface-csi",children:"Camera Serial Interface (CSI)"}),"\n",(0,t.jsx)(n.p,{children:"Currently, RUBIK Pi 3 is compatible with two Raspberry Pi cameras. The following table lists the supported resolutions for each camera module."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Resolution"}),(0,t.jsx)(n.th,{children:"Aspect Ratio"}),(0,t.jsx)(n.th,{children:"IMX477"}),(0,t.jsx)(n.th,{children:"IMX219"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"4056 x 3040"}),(0,t.jsx)(n.td,{children:"4:3"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"4608 x 2592"}),(0,t.jsx)(n.td,{children:"16:9"}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"3280 x 2464"}),(0,t.jsx)(n.td,{children:"4:3"}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:"Yes"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1920 x 1080"}),(0,t.jsx)(n.td,{children:"16:9"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1632 x 1224"}),(0,t.jsx)(n.td,{children:"4:3"}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:"Yes"})]})]})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Raspberry Pi High Quality Camera\uff08IMX477/M12 Mount\uff09",(0,t.jsx)(n.a,{href:"https://www.raspberrypi.com/products/raspberry-pi-high-quality-camera/",children:"Purchase link"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(6283).A+"",width:"4096",height:"3072"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Raspberry Pi Camera Module 2 (IMX219) ",(0,t.jsx)(n.a,{href:"https://www.raspberrypi.com/products/camera-module-v2/",children:"Purchase link"})]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Currently, RUBIK Pi 3 only supports the standard Camera Module 2 and does not support the wide-angle or NoIR versions."})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"connect-the-camera-cable",children:"Connect the camera cable"}),"\n",(0,t.jsx)("a",{id:"cameracable"}),"\n",(0,t.jsxs)(n.p,{children:["RUBIK Pi 3 supports the 22-pin FPC with a 0.5mm pitch and a 0.3\xb10.05mm thickness. It is compatible with the ",(0,t.jsx)(n.a,{href:"https://www.raspberrypi.com/products/camera-cable/",children:"Raspberry Pi 5 FPC"})," of the same specification."]}),"\n",(0,t.jsx)(n.admonition,{type:"danger",children:(0,t.jsx)(n.p,{children:"Never plug or unplug the camera module while the board is powered on, as this can easily damage the camera module."})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(3341).A+"",width:"4096",height:"3072"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Pull up the lock of the connector."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(1897).A+"",width:"4096",height:"3072"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Insert the FPC. Ensure that the contacts are toward the center of RUBIK Pi 3."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(1092).A+"",width:"4096",height:"3072"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"To secure the camera, slide the black lock down (and out a little) so that its locked position is parallel to the board."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(7155).A+"",width:"4096",height:"3072"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"use-cameras",children:"Use cameras"}),"\n",(0,t.jsx)(n.p,{children:"Connect cameras to connectors 13 and 14 in the following figure."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(834).A+"",width:"924",height:"730"})}),"\n",(0,t.jsx)(n.p,{children:"The following picture shows the physical connection:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(1611).A+"",width:"4096",height:"3072"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Preparations","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Add the Qualcomm and RUBIK Pi public personal package archive (PPA) to your RUBIK Pi 3 Ubuntu software sources.","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sudo add-apt-repository ppa:ubuntu-qcom-iot/qcom-noble-ppa\r\nsudo sed -i '$a deb http://apt.rubikpi.ai ppa main' /etc/apt/sources.list\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Install camera software.","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sudo apt update\r\nsudo apt install -y qcom-ib2c qcom-camera-server qcom-camx\r\nsudo apt install -y rubikpi3-cameras\r\nsudo apt install gstreamer1.0-qcom-sample-apps\r\nsudo chmod -R 777 /opt\r\nsudo mkdir -p /var/cache/camera/\r\nsudo touch /var/cache/camera/camxoverridesettings.txt\r\necho  enableNCSService=FALSE >> /var/cache/camera/camxoverridesettings.txt\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Reboot.","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sudo reboot\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Test taking photos","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# CAM1, output file /opt/img0_123.jpg\r\ngst-launch-1.0 -e qtiqmmfsrc camera=0 ! video/x-raw,format=NV12,width=1280,height=720,framerate=30/1 ! queue ! jpegenc ! queue ! multifilesink location=/opt/img0_%d.jpg max-files=5\r\n\r\n# CAM2, output file /opt/img1_123.jpg\r\ngst-launch-1.0 -e qtiqmmfsrc camera=1 ! video/x-raw,format=NV12,width=1280,height=720,framerate=30/1 ! queue ! jpegenc ! queue ! multifilesink location=/opt/img1_%d.jpg max-files=5\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"troubleshoot-camera-issues",children:"Troubleshoot camera issues"}),"\n",(0,t.jsx)(n.p,{children:"If the camera fails to display or capture ../images, check the following contents:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Check the camera module connection."}),"\n",(0,t.jsxs)(n.p,{children:["For details, refer to ",(0,t.jsx)(n.a,{href:"#cameracable",children:"Connect the camera cable"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Run the following command to collect logs."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"journalctl -f > /opt/log.txt\n"})}),"\n",(0,t.jsx)(n.p,{children:'Search for "probe success" in the logs. "probe success" indicates that the camera module is powered on and responding to I2C control. If the sensor does not have the "probe success" log, the possible cause is the flex cable connection or camera module issue.'}),"\n",(0,t.jsx)(n.p,{children:"The following log indicates that an IMX477 is detected:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"[   80.645992] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 939: Probe success,slot:7,slave_addr:0x34,sensor_id:0x477, is always on: 0\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Check the camera sensor driver command."}),"\n",(0,t.jsxs)(n.p,{children:["Collect logs using the ",(0,t.jsx)(n.code,{children:"journalctl -f > /opt/log.txt"}),' command and search for "cam_sensor_driver_cmd" in the logs. "CAM_START_DEV Success" indicates that the camera sensor streaming started. "CAM_STOP_DEV Success" indicates that the camera sensor streaming has stopped. For example:']}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\r\nstart:\r\n[   81.172814] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 1129: CAM_START_DEV Success, sensor_id:0x477,sensor_slave_addr:0x34\r\nstop:\r\n[   88.905241] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 1157: CAM_STOP_DEV Success, sensor_id:0x477,sensor_slave_addr:0x34\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Check the sensor streaming."}),"\n",(0,t.jsx)(n.p,{children:"Enable the CSID SOF/EOF IRQ logs, then execute the camera streaming command."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"mount -o rw,remount /usr\r\nmount -t debugfs none /sys/kernel/debug/\r\necho 0x8 > /sys/module/camera/parameters/debug_mdl\r\necho 3 >/sys/kernel/debug/camera_ife/ife_csid_debug\r\necho 1 > /sys/kernel/tracing/tracing_on\r\necho 1 > /sys/kernel/tracing/events/camera/cam_log_debug/enable\r\necho 2 > /sys/module/camera/parameters/debug_type\r\ncat /sys/kernel/tracing/trace_pipe > trace.txt\r\n\n"})}),"\n",(0,t.jsx)(n.p,{children:'The captured logs provide detailed information about the Start of Frame (SOF) and End of Frame (EOF). In the trace.txt log, search for "irq_status_ipp".'}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"BIT12 (0x1000) represents the SOF packet."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"BIT9 (0x200) represents the EOF packet."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The log will appear as follows:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"<idle>-0       [000] d.h1. 19287.546764: cam_log_debug:\r\nCAM_DBG: CAM-ISP: cam_ife_csid_irq: 4996: irq_status_ipp = 0x1110 cam-server-25604     [000] dNH.. 19287.561705: cam_log_debug:\r\nCAM_DBG: CAM-ISP: cam_ife_csid_irq: 4996: irq_status_ipp = 0xee8\n"})}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},3341:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/20250314-155515-334eb55e6c58b28d65b5ce1379422347.jpg"},6283:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/20250314-155508-39f4a9abef201de51ed4d22035933e96.jpg"},7155:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/20250314-155500-2e5916cec6941b2878120fa2e6686eb7.jpg"},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>i});var s=r(6540);const t={},a=s.createContext(t);function c(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),s.createElement(a.Provider,{value:n},e.children)}},9365:(e,n,r)=>{r.d(n,{A:()=>c});r(6540);var s=r(4164);const t={tabItem:"tabItem_Ymn6"};var a=r(4848);function c({children:e,hidden:n,className:r}){return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.A)(t.tabItem,r),hidden:n,children:e})}}}]);